<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Thông tin hồ sơ</title>
  <script src="auth.js"></script>
</head>
<body onload="loadProfile()">

  <h2>Hồ sơ nhân viên</h2>

  <div id="profileBox">Đang tải thông tin...</div>

  <br>
  <a href="dashboard.html">← Quay lại Dashboard</a>

  <script>
    async function loadProfile() {
      const token = localStorage.getItem("session_token");

      if (!token) {
        window.location.href = "login.html";
        return;
      }

      const res = await api("getUserInfo", { token });

      if (!res.success) {
        alert("Session đã hết hạn, vui lòng đăng nhập lại.");
        localStorage.removeItem("session_token");
        window.location.href = "login.html";
        return;
      }

      const user = res.user;

      let html = "<table border='1' cellpadding='6'>";

      for (let key in user) {
        html += `
          <tr>
            <td><b>${key}</b></td>
            <td>${user[key]}</td>
          </tr>
        `;
      }

      html += "</table>";

      document.getElementById("profileBox").innerHTML = html;
    }
  </script>

</body>
</html>
